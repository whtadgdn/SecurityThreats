---
title: "Основы обработки данных с помощью R и Dplyr"
subtitle: "Отчет по практике 2"
author: "Zid4a84@yandex.ru"
format: 
  md:
    output-file: README.md
---

## Цель работы

1. Развить практические навыки использования языка программирования R для обработки данных
2. Закрепить знания базовых типов данных языка R
3. Развить практические навыки использования функций обработки данных пакета dplyr – функции select(), filter(), mutate(), arrange(), group_by()


---

## Исходные данные

1. Программное обеспечение: **OC Windows 11 Pro**  
2. Среда разработки: **RStudio**  
3. Интерпретатор языка: **R 4.5.1**  
4. Используемый пакет: **dplyr**

---

## План

1. Установить пакет `dplyr`.  
2. Проанализировать встроенный в пакет `dplyr` набор данных `starwars` с помощью языка **R** и ответить на вопросы:

   1. Сколько строк в датафрейме?  
   2. Сколько столбцов в датафрейме?  
   3. Как просмотреть примерный вид датафрейма?  
   4. Сколько уникальных рас персонажей (`species`) представлено в данных?  
   5. Найти самого высокого персонажа.  
   6. Найти всех персонажей ниже 170 см.  
   7. Подсчитать индекс массы тела (ИМТ) для всех персонажей.  
      Формула:  
      $$I = \frac{m}{h^2}$$  
      где *m* — масса (mass), *h* — рост (height).  
   8. Найти 10 самых “вытянутых” персонажей (отношение `mass/height`).  
   9. Найти средний возраст персонажей каждой расы (`species`).  
   10. Найти самый распространённый цвет глаз персонажей.  
   11. Подсчитать среднюю длину имени в каждой расе.

---

## Шаги

---
### Установка dplyr

install.packages("dplyr")
WARNING: Rtools is required to build R packages but is not currently installed. Please download and install the appropriate version of Rtools before proceeding:

https://cran.rstudio.com/bin/windows/Rtools/
Устанавливаю пакет в ‘C:/Users/Zid4a/AppData/Local/R/win-library/4.5’
(потому что ‘lib’ не определено)
пробую URL 'https://cran.rstudio.com/bin/windows/contrib/4.5/dplyr_1.1.4.zip'
Content type 'application/zip' length 1593482 bytes (1.5 MB)
downloaded 1.5 MB

пакет ‘dplyr’ успешно распакован, MD5-суммы проверены

Скачанные бинарные пакеты находятся в
	C:\Users\Zid4a\AppData\Local\Temp\RtmpOU8nnE\downloaded_packages


### Подключение dplyr
```{r}
library(dplyr)
```

### Сколько строк в датафрейме?
```{r}
nrow(starwars)
```


### Сколько столбцов в датафрейме?
```{r}
ncol(starwars)
```

### Как просмотреть примерный вид датафрейма?
```{r}
glimpse(starwars)
```


### Сколько уникальных рас персонажей (species) представлено в данных?
```{r}
starwars %>% summarise(количество_уникальных_рас = n_distinct(species))
```


### Найти самого высокого персонажа.
```{r}
starwars %>%
      filter(height == max(height, na.rm = TRUE))
```


### Найти всех персонажей ниже 170
```{r}
starwars %>% filter(height < 170)
```


### Подсчитать ИМТ (индекс массы тела) для всех персонажей.
```{r}
starwars %>%
     mutate(height_m = height / 100,bmi = mass / (height_m)^2) %>%
     select(name, mass, height, bmi)
```


### Найти 10 самых “вытянутых” персонажей.“Вытянутость” оценить по отношению массы (mass) к росту (height) персонажей.
```{r}
 starwars %>% 
     mutate(stretch_ratio = mass / height) %>% 
     arrange(desc(stretch_ratio)) %>% 
     slice_head(n = 10)
```


### Найти средний возраст персонажей каждой расы вселенной Звездных войн.
```{r}
starwars %>%
     mutate(current_year = 100,age = current_year + birth_year) %>%
     filter(!is.na(age) & !is.na(species)) %>%
     group_by(species) %>%
     summarise(average_age = mean(age),count = n()) %>%
     arrange(desc(average_age))
```


### Найти самый распространенный цвет глаз персонажей вселенной Звездных войн.
```{r}
starwars %>% 
     filter(!is.na(eye_color)) %>% 
     count(eye_color, sort = TRUE) %>% 
     slice(1)
```


### Подсчитать среднюю длину имени в каждой расе вселенной Звездных войн.
```{r}
starwars %>%
     filter(!is.na(name) & !is.na(species)) %>%
     group_by(species) %>%
     summarise(average_name_length = mean(nchar(name)))
```

## Оценка результатов

В данной практической работе мы применили знания полученные в результате первой практической работы для обработки массива данных.

## Вывод

Таким образом, мы развили практические навыки использования функций обработки данных пакета dplyr – функции select(), filter(), mutate(), arrange(), group_by()